<!-- markdown-link-check-disable-next-line -->
## [![Nabla](http://albandrieu.com/nabla/index/assets/nabla/nabla-4.png)](https://github.com/AlbanAndrieu) nabla-servers-bower-sample

[![License: APACHE](http://img.shields.io/:license-apache-blue.svg?style=flat-square)](http://www.apache.org/licenses/LICENSE-2.0.html)
[![License: MIT](https://img.shields.io/badge/license-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Gitter](https://badges.gitter.im/nabla-servers-bower-sample/Lobby.svg)](https://gitter.im/nabla-servers-bower-sample/Lobby?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge)
[![Join the chat at https://gitter.im/AlbanAndrieu/warnings-plugin](https://badges.gitter.im/AlbanAndrieu/warnings-plugin.svg)](https://gitter.im/AlbanAndrieu/warnings-plugin?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge)
[![Minimal java version](https://img.shields.io/badge/java-1.8-yellow.svg)](https://img.shields.io/badge/java-1.8-yellow.svg)

[![Jenkins Version](https://img.shields.io/badge/Jenkins-2.221-green.svg?label=min.%20Jenkins)](https://jenkins.io/download/)
[![GitHub release (latest SemVer)](https://img.shields.io/github/v/release/AlbanAndrieu/nabla-servers-bower-sample?label=changelog)](https://github.com/AlbanAndrieu/nabla-servers-bower-sample/releases)

Javascript project

## Overview

![](https://raw.githubusercontent.com/AlbanAndrieu/nabla-servers-bower-sample/master/screenshot-overview.png)

## Build

[![Grunt](https://gruntjs.com/cdn/builtwith.png)](http://gruntjs.com/)
[![Travis Build Status](https://travis-ci.org/AlbanAndrieu/nabla-servers-bower-sample.svg?branch=master)](https://travis-ci.org/AlbanAndrieu/nabla-servers-bower-sample)
<!--[![Jenkins Build Status](http://albandrieu.com/jenkins/job/nabla-servers-bower-sample-nightly/badge/icon)](http://albandrieu.com/jenkins/job/nabla-servers-bower-sample-nightly)-->
[![Build Status](https://github.com/AlbanAndrieu/nabla-servers-bower-sample/actions/workflows/maven-build.yml/badge.svg)](https://github.com/AlbanAndrieu/nabla-servers-bower-sample/actions/workflows/maven-build.yml)
[![Release Charts](https://github.com/AlbanAndrieu/nabla-servers-bower-sample/actions/workflows/release.yml/badge.svg)](https://github.com/AlbanAndrieu/nabla-servers-bower-sample/actions/workflows/release.yml)

## Quality

[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=com.nabla.project.servers.sample%3Abower-sample&metric=alert_status)](https://sonarcloud.io/summary/new_code?id=com.nabla.project.servers.sample%3Abower-sample)
[![Coverage](https://sonarcloud.io/api/project_badges/measure?project=com.nabla.project.servers.sample%3Abower-sample&metric=coverage)](https://sonarcloud.io/summary/new_code?id=com.nabla.project.servers.sample%3Abower-sample)
[![Technical Debt](https://sonarcloud.io/api/project_badges/measure?project=com.nabla.project.servers.sample%3Abower-sample&metric=sqale_index)](https://sonarcloud.io/summary/new_code?id=com.nabla.project.servers.sample%3Abower-sample)

[![js-standard-style](https://img.shields.io/badge/code%20style-standard-brightgreen.svg?style=flat-square)](https://github.com/AlbanAndrieu/nabla-servers-bower-sample)

[![Code Climate](https://codeclimate.com/github/AlbanAndrieu/nabla-servers-bower-sample/badges/gpa.svg)](https://codeclimate.com/github/AlbanAndrieu/nabla-servers-bower-sample)
[![Test Coverage](https://codeclimate.com/github/AlbanAndrieu/nabla-servers-bower-sample/badges/coverage.svg)](https://codeclimate.com/github/AlbanAndrieu/nabla-servers-bower-sample/coverage)
[![Known Vulnerabilities](https://snyk.io/test/github/albanandrieu/nabla-servers-bower-sample/badge.svg)](https://snyk.io/test/github/albanandrieu/nabla-servers-bower-sample)

## Info

[![Branch](http://img.shields.io/github/tag/AlbanAndrieu/nabla-servers-bower-sample.svg?style=flat-square)](https://github.com/AlbanAndrieu/nabla-servers-bower-sample/tree/master)
[![Platforms](http://img.shields.io/badge/platforms-ubuntu-lightgrey.svg?style=flat)](#)

[![Last deployed](https://img.shields.io/github/last-commit/AlbanAndrieu/nabla-servers-bower-sample/gh-pages.svg?label=last%20deployed)](https://github.com/AlbanAndrieu/nabla-servers-bower-sample/commits/gh-pages)

## Tools

[![social-likes-next](https://data.jsdelivr.com/v1/package/npm/social-likes-next/badge)](https://www.jsdelivr.com/package/npm/social-likes-next)

## Contributing [![contributions welcome](https://img.shields.io/badge/contributions-welcome-brightgreen.svg?style=flat)](https://github.com/AlbanAndrieu/nabla-servers-bower-sample/issues) [![bounties](https://img.shields.io/bountysource/team/pycontribs/activity.svg)](https://www.bountysource.com/teams/nabla-servers-bower-sample/issues?tracker_ids=3650997)

[![GitHub issues by-label](https://img.shields.io/github/issues/AlbanAndrieu/nabla-servers-bower-sample/good%20first%20issue.svg)](https://github.com/AlbanAndrieu/nabla-servers-bower-sample/issues?q=is%3Aissue+is%3Aopen+label%3A%22good+first+issue%22)
[![GitHub pull requests by-label](https://img.shields.io/github/issues-pr/AlbanAndrieu/nabla-servers-bower-sample/good%20first%20issue.svg)](https://github.com/AlbanAndrieu/nabla-servers-bower-sample/pulls?q=is%3Apr+is%3Aopen+label%3A%22good+first+issue%22)

[![Maintainers Wanted](https://img.shields.io/badge/maintainers-wanted-red.svg)](https://github.com/AlbanAndrieu/nabla-servers-bower-sample/)

## Why? [![start with why](https://img.shields.io/badge/start%20with-why%3F-brightgreen.svg?style=flat)](http://www.ted.com/talks/simon_sinek_how_great_leaders_inspire_action)

<!--
[![Grunt](https://cdn.gruntjs.com/builtwith.png)](http://gruntjs.com/)
[![Flattr this git repo](http://api.flattr.com/button/flattr-badge-large.png)](https://flattr.com/submit/auto?user_id=AlbanAndrieu&url=https://github.com/AlbanAndrieu/nabla-servers-bower-sample&title=nabla-servers-bower-sample&language=en_GB&tags=github&category=software)
[![Inline docs](http://inch-ci.org/github/{ORG-or-USERNAME}/{REPO-NAME}.svg?branch=master)](http://inch-ci.org/github/{ORG-or-USERNAME}/{REPO-NAME})
[![Xing](http://www.xing.com/img/buttons/45_fr_btn.gif)](http://www.xing.com/profile/Alban_Andrieu)
-->

[![Website](https://img.shields.io/website-up-down-green-red/http/shields.io.svg?label=nabla)](http://albanandrieu.com)

# Table of contents

<!-- markdown-link-check-disable -->

// spell-checker:disable

<!-- toc -->

- [A bower project sample](#a-bower-project-sample)
  * [Create project](#create-project)
  * [Tools](#tools)
    + [Internationalization](#internationalization)
    + [GitHub cards](#github-cards)
    + [TODO](#todo)
  * [Quality tools](#quality-tools)
    + [python 3.6](#python-36)
    + [pre-commit](#pre-commit)
    + [pre-commit specific hook](#pre-commit-specific-hook)
    + [takari maven wrapper](#takari-maven-wrapper)
  * [NODE/NPM Installation](#nodenpm-installation)
    + [Using nvm](#using-nvm)
    + [Using apt](#using-apt)
  * [Installation](#installation)
  * [Build & development](#build--development)
    + [Docker image](#docker-image)
      - [Pull image](#pull-image)
      - [Start container](#start-container)
      - [Maven](#maven)
      - [Docker compose](#docker-compose)
  * [Documentation](#documentation)
  * [Fix imagemin upgrade](#fix-imagemin-upgrade)
  * [List browser compatibility](#list-browser-compatibility)
  * [Testing](#testing)
  * [Livereload](#livereload)
  * [Proxy / Rewrite jetty](#proxy--rewrite-jetty)
  * [Run war in jetty or using cargo](#run-war-in-jetty-or-using-cargo)
  * [ZaProxy](#zaproxy)
  * [Selenium Grid](#selenium-grid)
  * [Jenkins](#jenkins)
  * [Yslow Psi WebPageTest](#yslow-psi-webpagetest)
  * [Refresh from upstream](#refresh-from-upstream)
  * [Deploy to internet](#deploy-to-internet)
  * [Performance improvements](#performance-improvements)
  * [Issues](#issues)
  * [Run End2End tests](#run-end2end-tests)
  * [Eclipse](#eclipse)
    + [Import as Maven project](#import-as-maven-project)
    + [Java](#java)
  * [Terraform](#terraform)
    + [Init](#init)
      - [Using terraform cloud to store Terraform State](#using-terraform-cloud-to-store-terraform-state)
      - [Using consul backend to Terraform State in KV](#using-consul-backend-to-terraform-state-in-kv)
    + [Applying terraform](#applying-terraform)
    + [Update terraform documentation](#update-terraform-documentation)
  * [Requirements](#requirements)
  * [Providers](#providers)
  * [Modules](#modules)
  * [Resources](#resources)
  * [Inputs](#inputs)
  * [Outputs](#outputs)
    + [Check docker image quality](#check-docker-image-quality)
      - [Docker dive](#docker-dive)
      - [Docker linter](#docker-linter)
      - [mega-linter](#mega-linter)
      - [Check secret](#check-secret)
      - [Check cspell](#check-cspell)
    + [Update README.md](#update-readmemd)
  * [Other resources](#other-resources)
- [Contributing](#contributing)
  * [License](#license)

<!-- tocstop -->

// spell-checker:enable

<!-- markdown-link-check-enable -->

# A bower project sample

This project is generated with [yo angular generator](https://github.com/yeoman/generator-angular) version 0.11.1.
Then I applied [uncss generator](https://github.com/addyosmani/generator-webapp-uncss)

This project is also used to test integration of build tools like:

- private-bower (bower repo and caching)
- nexus (npm and java packages repo and caching)
- jenkins (continuous delivery in a jetty embedded)
- sonar multi-languages and coverage (QA metrics except JIRA and perf metrics)
- yeoman/nodejs/npm/grunt/bower and maven integration
- zaproxy (security tests), checkmarx, dependency-check and nsp (thirdparty security check)
- performance (jmx, phantomas, pagespeed, webpagetest, yslow, junitperf in jenkins)
- sonar / stash / jira / jenkins /git /checkmarx integration

languages like :

- javascript
  - unit tests (karma) + LCOV coverage
  - end2end tests (protractor)
- java
  - unit tests (junit and jmockit) + Jacoco coverage
  - integration tests (junit) + Jacoco coverage
- groovy
  - unit tests (junit) + Jacoco coverage
  - integration tests (junit) + Jacoco coverage

jmeter, gatling, mutation testing and arquillian are available in other sample project

## Create project

as local user

```bash
#npm install generator-angular
#npm install generator-angular-fullstack
yarn config set "strict-ssl" false -g
#yarn config set cafile ~/NABLA.crt
set NODE_TLS_REJECT_UNAUTHORIZED=0
yarn install

```

as local user

```bash
yo angular translate
```

# Initiate

```bash
rm -Rf .venv/ .direnv/
direnv allow
```

## Tools

### Internationalization

[angular-internationalization-tutorials](https://scotch.io/tutorials/internationalization-of-angularjs-applications)

[angular-translate-yeoman](https://github.com/malyw/angular-translate-yeoman/compare/yeoman-angular-clean...master)

### GitHub cards

[GitHub cards](https://lab.lepture.com/github-cards/#AlbanAndrieu/nabla-servers-bower-sample|default)

### TODO

TODO use <https://angular-ui.github.io/bootstrap/> for language
TODO remvove app/styles/components/\_header.scss language-select
TODO <https://github.com/rackerlabs/angular-bootstrap-nav>
SEE <https://github.com/dlukez/angular-bootstrap-select/blob/master/angular-bootstrap-select.js>
SEE <https://github.com/angular-ui/angular-google-maps>

## Quality tools

### python 3.8

Install python 3.8 and virtualenv

```bash
virtualenv --no-site-packages /opt/ansible/env38 -p python3.8
source /opt/ansible/env36/bin/activate
pip install -r requirements-current-3.8.txt
```

### pre-commit

See [pre-commit](http://pre-commit.com/)
Run `pre-commit install`
Run `pre-commit autoupdate`

First time run `cp hooks/* .git/hooks/` or `rm -Rf ./.git/hooks/ && ln -s ../hooks ./.git/hooks && git checkout hooks/`

Run `pre-commit run --all-files`

Run `SKIP=ansible-lint git commit -am 'Add key'`
Commit `git commit -am 'TEST' --no-verify`

### pre-commit specific hook

`export JIRA_USER=aandrieu`

`export JIRA_PASSWORD=XXX`

Run custom hook `pre-commit run git-branches-check`

### takari maven wrapper

See [takari-maven-wrapper](https://github.com/takari/maven-wrapper)

```bash
mvn -N io.takari:maven:wrapper
```

## NODE/NPM Installation

### Using nvm

See [nvm](https://github.com/nvm-sh/nvm)

```bash
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash

nvm ls-remote --lts
nvm --version
nvm version

nvm install 14
nvm install 16
nvm use 16
```

### Using apt

```bash
curl -sL https://deb.nodesource.com/setup_16.x | bash - &&
apt-get update && apt-get install --no-install-recommends -y nodejs=16*

#npm cache clean -f
npm install -g n
#n stable
n 11.12.0
node -v
#v11.12.0
/usr/local/bin/node -v
npm install -g npm@6.13.6
env PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true npm install -g puppeteer@0.12.0
env PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true yarn global add puppeteer
```

## Installation

Install NPM modules.

```bash
npm install
```

Install Javascript dependencies.

```bash
bower install
```

## Build & development

### Docker image

Build image is :
See [ansible-jenkins-slave-docker](https://hub.docker.com/ansible-jenkins-slave-docker/)

#### Pull image

```bash
docker pull registry.hub.docker.com/nabla/ansible-jenkins-slave-test:latest
```

#### Start container

```
#Sample using container to buid my local workspace
id albandri
#uid=1000(albandri) gid=999(docker) groups=999(docker)
docker run -it -u 1000:999 --userns=host -v /etc/passwd:/etc/passwd:ro -v /etc/group:/etc/group:ro -v /var/run/docker.sock:/var/run/docker.sock -v /data1/home/albandri/:/data1/home/albandri/ -v /workspace/users/albandri30:/workspace/users/albandri30 -w /sandbox/project-to-build -v /workspace/users/albandri30/bower-fr-integration-test/:/sandbox/project-to-build:rw -v /jenkins:/home/jenkins -v /jenkins:/jenkins -v /etc/bash_completion.d:/etc/bash_completion.d:ro --name sandbox --entrypoint /bin/bash registry.hub.docker.com/nabla/ansible-jenkins-slave:latest
```

#### Maven

Run `mvnw clean install` for building.
Run `grunt` for building and `grunt serve` for preview.
Run `mvnw site -Dskip.npm -Dskip.yarn -Dskip.bower -Dskip.grunt` for building site.

```bash
mvnw clean install -Dserver=jetty9x
#mvnw clean install -Dserver=jetty9x -Dskip.npm -Dskip.grunt -Dskip.bower -Dskip.yarn
mvnw verify gpg:sign -Dgpg.passphrase=thephrase 2>&1 sign.log
npm ls --licenses
```

Run `mvnw site -Dskip.npm -Dskip.yarn -Dskip.bower -Dskip.grunt` for building site.

as root

```bash
npm uninstall grunt-contrib-imagemin && npm install grunt-contrib-imagemin
```

#### Docker compose

```bash
cd ./docker-compose
./docker-compose-up.sh
docker-compose -f ./docker-compose.yml -f ./docker-compose.dev.yml -p test up --force-recreate -d web
#docker-compose -f ./docker-compose.monitoring.yml -p monitoring up -d nexus
docker-compose -f ./docker-compose.monitoring.yml -p monitoring up -d
cd /opt/harbor
sudo docker-compose -f ./docker-compose.yml up -d
```

## Documentation

See [mkdocs](https://www.mkdocs.org/)

Run `mkdocs` for building doc and `mkdocs serve` for preview.

```bash
mkdocs serve
mkdocs build
mkdocs gh-deploy
#mkdocs gh-deploy -b docs
```

[GitHub Pages](http://albanandrieu.github.io/nabla-servers-bower-sample/)
[github-pages](https://docs.github.com/en/pages/getting-started-with-github-pages)

## Fix imagemin upgrade

```bash
npm install optipng-bin@3.1.4
grunt imagemin:dist
```

## List browser compatibility

```bash
npx browserslist
```

## Testing

test (dev mode)

```bash
grunt serve watch -v
```

test (deployment mode)

```bash
grunt serve:dist
```

Running `grunt test` will run the unit tests with karma.

## Livereload

Run with grunt watch -v then manually edit a file listed in the watch.livereload.files array. Ensure that it is triggering the file by printing the file name to the console.

Then from the browser end, ensure going to <http://localhost:35730/> works and displays {"tinylr":"Welcome","version":"0.2.1"} letting you know the live reload server is running.

Be sure the <http://localhost:35730/livereload.js> script is being loaded and you see the network socket being established.

## Proxy / Rewrite jetty

Proxy can be used to get access to oter URL.
In order to be activated it must be reached once : <http://localhost:9090/login>

Even though it is strongly advice to run this project behind an apache.
Please use : [ansible-web](https://github.com/AlbanAndrieu/ansible-web) in order to install this project behind an apache.

## Run war in jetty or using cargo

```bash
mvnw jetty:run-war
mvnw install org.codehaus.cargo:cargo-maven2-plugin:run -Dserver=jetty9x > install.log
```

## ZaProxy

Needed for having /usr/bin/xml2-config in the PATH

```bash
sudo apt-get install libxml2-dev libxslt-dev
```

Note that ZAProxy must be installed and zap.sh must be available on the executable path for this to work.
Make sure you are running zap 2.3.0 or 2.3.1

```bash
export PATH=/usr/local/zap/zap-2.3.0/:${PATH}
```

In case of trouble with zap locally.
Please deactivate html report in Gruntfile.js
html: false

Please use : [ansible-zaproxy](https://github.com/AlbanAndrieu/ansible-zaproxy) in order to install zaproxy

Start zap by hand:

```bash
sudo su - jenkins
export DISPLAY=:99 && nohup /usr/local/zap/zap-2.3.1/zap.sh -daemon -port 8090 > zap.log &
tail -f zap.log
```

## Selenium Grid

How to start selenium grid

```bash
#ssh -X root@albandrieu.com
sudo su - jenkins
#start by hand selenium grid
rm nohup.out
nohup java -jar /workspace/selenium-server-standalone-2.52.0.jar -Dwebdriver.chrome.driver=/usr/lib/chromium-browser/chromedriver -role hub -port 4444 -host 192.168.0.29 -debug &
tail -f nohup.out
#check hub is working
INFO - Nodes should register to http://albandrieu.com:4444/grid/register/
#start by hand selenium instance for albandrieu.com
ssh -X jenkins@albandrieu.com
#https://github.com/SeleniumHQ/selenium/wiki/Grid2
#export DISPLAY=localhost:99.0 && nohup java -jar /workspace/selenium-server-standalone-2.52.0.jar -role node -hub http://albandrieu.com:4444/wd/register -browser browserName=firefox,version=38.0,firefox_binary=/usr/bin/firefox,maxInstances=1,platform=LINUX -browser browserName=chrome,version=39.0.2171.95,chrome_binary=/opt/google/chrome/chrome,maxInstances=1,platform=LINUX &
#export DISPLAY=localhost:99.0 && nohup java -jar /workspace/selenium-server-standalone-2.52.0.jar -role node -hub http://127.0.0.1:4444/grid/register -browser browserName=firefox,version=40.0,firefox_binary=/usr/bin/firefox,maxInstances=1,platform=LINUX -browser browserName=chrome,version=43.0.2357.125,chrome_binary=/usr/bin/google-chrome,maxInstances=1,platform=LINUX clean install -Dserver=jetty9x -Dsurefire.useFile=false -Psample,jacoco,integration,run-its,arq-weld-ee-embedded -Darquillian=arq-weld-ee-embedded -Darquillian.launch=arq-weld-ee-embedded -Dwebdriver.chrome.driver=/usr/lib/chromium-browser/chromedriver -debug > selenum-hub.out 2>&1 &
#master
export DISPLAY=localhost:99.0 && nohup java -jar /workspace/selenium-server-standalone-2.53.0.jar -Dwebdriver.chrome.driver=/usr/lib/chromium-browser/chromedriver -role node -hub http://127.0.0.1:4444/grid/register -browser browserName=firefox,version=58.0.2,firefox_binary=/usr/bin/firefox,maxInstances=1,platform=LINUX -browser browserName=chrome,version=48.0.2564.116,chrome_binary=/usr/bin/google-chrome,maxInstances=1,platform=LINUX -debug > selenum-hub.out 2>&1 &
#ubuntu
export DISPLAY=localhost:99.0 && nohup java -jar /workspace/selenium-server-standalone-2.53.0.jar -Dwebdriver.chrome.driver=/usr/lib/chromium-browser/chromedriver -role node -hub http://192.168.0.29:4444/grid/register -host 192.168.0.18 -timeout 500 -maxSession 2 -browser browserName=firefox,version=51.0.1,firefox_binary=/usr/bin/firefox,maxInstances=3,platform=LINUX -browser browserName=chrome,version=50.0.2661.102,chrome_binary=/usr/bin/google-chrome,maxInstances=3,platform=LINUX -debug > selenum-hub.out 2>&1 &
#freenas
export DISPLAY=localhost:99.0 && nohup java -jar /workspace/selenium-server-standalone-2.53.0.jar -Dwebdriver.chrome.driver=/usr/lib/chromium-browser/chromedriver -role node -hub http://192.168.0.29:4444/grid/register -host 192.168.0.26 -timeout 500 -maxSession 2 -browser browserName=firefox,version=58.0,firefox_binary=/usr/local/bin/firefox,maxInstances=3,platform=LINUX -browser browserName=chrome,version=61.0.3163.100,chrome_binary=/usr/local/bin/chrome,maxInstances=3,platform=LINUX -debug > selenum-hub.out 2>&1 &
multitail nohup.out selenum-hub.out

curl http://localhost:4444/grid/api/proxy?id=http://172.17.42.1:5555
curl http://albandrieu.com:4444/grid/console

/usr/bin/google-chrome
/opt/google/chrome/chrome --> NOK

#On albandrieu.com check starter script at
#/etc/init.d/selenium_hub
```

Check result at :

curl <http://albandrieu.com:4444/grid/console>

<http://albandrieu.com:4444/grid/console>

<http://192.168.0.29:5555/wd/hub/static/resource/hub.html>

Please use : [ansible-selenium](https://github.com/AlbanAndrieu/ansible-selenium) in order to install selenium hub and node

## Jenkins

In order to properly configure Jenkins master

```bash
ADD /zapSource/build/zap in
sudo nano /etc/init/jenkins.conf
export JENKINS_HOME
export ZAPROXY_HOME=/zapSource/build/zap
export PATH=$PATH:$ZAPROXY_HOME
```

## Yslow Psi WebPageTest

Run yslow, Psi or webpagetest

```bash
#grunt yslow_test
npm run pretest
grunt pagespeed
grunt wpt
```


## Refresh from upstream

```bash
git remote add upstream https://github.com/AlbanAndrieu/nabla-servers-bower-sample.git
git remote -v
git fetch upstream
git checkout master
git rebase upstream/master
git rebase --continue
git push origin master --force
```

## Deploy to internet

```bash
grunt gh-pages --gh-pages-tag 'v1.0.3' --gh-pages-message 'Tagging v1.0.3'
```

Page deployed at :

[GitHub IO](http://albanandrieu.github.io/nabla-servers-bower-sample/)

[GitHub gh-pages](http://htmlpreview.github.io/?https://github.com/AlbanAndrieu/nabla-servers-bower-sample/blob/gh-pages/index.html)

```bash
#VirtualHost *
sudo nano /etc/apache2/sites-available/awstats.conf
#VirtualHost *:7075
sudo nano /etc/apache2/sites-available/sample.conf
#Add the following
Alias /bower_components "/var/www/sample/bower_components"
Alias /fonts "/var/www/sample/fonts"
```

## Performance improvements

What has been done is described at <https://www.youtube.com/watch?v=FEs2jgZBaQA>

## Issues

[using-ui-bootstrap-causing-issues-with-carousel](http://stackoverflow.com/questions/26332202/using-ui-bootstrap-causing-issues-with-carousel)

In order to workaround issue of bower_components (cssmin) absolute path instead of releatif :
[how-to-avoid-grunt-build-not-loading-bootstrap-glyphicons-using-jhipster](http://ignaciosuay.com/how-to-avoid-grunt-build-not-loading-bootstrap-glyphicons-using-jhipster/)
[generator-angular](https://github.com/yeoman/generator-angular/issues/1011)

## Run End2End tests

```bash
mvnw clean install org.codehaus.cargo:cargo-maven2-plugin:run -Dserver=jetty9x
grunt --gruntfile Gruntfile-e2e.js
```

## Eclipse

Uninstall Nodeclipse Core & Node.js

Add plugins

- Groovy/Grails Tool Suite (GGTS) for Eclipse 3.6.4.RELEASE
- Nodeclipse "Enide Studio 2014" is Tool Suite for Node.js
- AngularJS Eclipse Plugin

### Import as Maven project

### Java

Project Properties | Java Build Path | Default output folder
Change target by target-eclipse
bower-sample/target-eclipse/classes

Exclude validation for

- node
- node_modules
- bower_components
- dist
- app
- coverage

## Terraform

### Init


#### Using terraform cloud to store Terraform State

```bash
terraform login
terraform init -backend-config=config.remote.tfbackend

terraform workspace list
```

#### Using consul backend to Terraform State in KV

```bash
terraform init -backend-config=config.consul.tfbackend
terraform init -reconfigure
#terraform init \
#-backend-config="address=10.30.0.66:8500" \
#-backend-config="path=uat/terraform_state" \
#-backend-config="scheme=http"
terraform plan
```

### Applying terraform

Apply vault configuration

```bash
terraform validate
terraform init
terraform fmt
terraform plan -input=false --out plan
terraform apply
terraform show
terraform destroy
```

```bash
terraform plan --destroy -out=example.plan
terraform show example.plan
terraform state list
```

```bash
terraform output -raw website_endpoint
aws s3 cp /workspace/users/albandrieu30/nabla-site-apache/ s3://nabla-tf-exemple-bucket/ --recursive
```

```bash
terraform graph | grep -v -e 'meta' -e 'close' -e 's3' -e 'vpc' > terraform.gv
terraform graph | grep -v -e 'meta' -e 'close' -e 's3' -e 'vpc' | dot -Tpng > terraform.png
```

### Update terraform documentation

```bash
terraform-docs .
```

<!-- BEGIN_TF_DOCS -->
## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | 1.2.5 |
| <a name="requirement_aws"></a> [aws](#requirement\_aws) | ~> 4.0 |

## Providers

| Name | Version |
|------|---------|
| <a name="provider_aws"></a> [aws](#provider\_aws) | 4.11.0 |

## Modules

| Name | Source | Version |
|------|--------|---------|
| <a name="module_site"></a> [site](#module\_site) | ./modules/site | n/a |

## Resources

| Name | Type |
|------|------|
| [aws_default_vpc.default](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/default_vpc) | resource |
| [aws_dynamodb_table.terraform_locks](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table) | resource |
| [aws_s3_bucket.terraform_state](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket) | resource |
| [aws_security_group.prod_web](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group) | resource |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_CI_PROJECT_NAME"></a> [CI\_PROJECT\_NAME](#input\_CI\_PROJECT\_NAME) | n/a | `string` | `"default"` | no |
| <a name="input_aws_region"></a> [aws\_region](#input\_aws\_region) | AWS region to launch servers. | `string` | `"eu-west-3"` | no |
| <a name="input_github_organization"></a> [github\_organization](#input\_github\_organization) | Github organization | `string` | `"Banbou"` | no |
| <a name="input_site"></a> [site](#input\_site) | Site Name | `string` | n/a | yes |
| <a name="input_website_bucket_name"></a> [website\_bucket\_name](#input\_website\_bucket\_name) | Nabla bower site | `string` | `"nabla-tf-site-bucket"` | no |
| <a name="input_website_root"></a> [website\_root](#input\_website\_root) | Path to the root of website content | `string` | `"./dist"` | no |
| <a name="input_whitelist"></a> [whitelist](#input\_whitelist) | n/a | `list(string)` | n/a | yes |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_dynamodb_table_name"></a> [dynamodb\_table\_name](#output\_dynamodb\_table\_name) | The name of the DynamoDB table |
| <a name="output_project_name"></a> [project\_name](#output\_project\_name) | n/a |
| <a name="output_s3_bucket_arn"></a> [s3\_bucket\_arn](#output\_s3\_bucket\_arn) | The ARN of the S3 bucket |
<!-- END_TF_DOCS -->


### Check docker image quality

#### Docker dive

```bash
dive --ci --json docker-dive-stats.json "${DOCKER_ORGANISATION}/pgclient:0.1.0" 1>docker-dive.log 2>docker-dive-error.log
```

#### Docker linter

```bash
sudo npm install -g dockerfile_lint
dockerfile_lint --json --verbose --dockerfile Dockerfile
```

```bash
brew install hadolint
hadolint Dockerfile
```

#### Ansible linter

```bash
ansible-lint --write ansible/
```

#### Mega linter

```bash
npx mega-linter-runner --install
npx mega-linter-runner
```

#### Check secret

```
npx @secretlint/quick-start "**/*"
```

#### Check cspell

```
npx cspell "**/*.{txt,js,md}"
```

### Update README.md

* [github-markdown-toc](https://github.com/jonschlinkert/markdown-toc)
* With [github-markdown-toc](https://github.com/Lucas-C/pre-commit-hooks-nodejs)

```
sudo npm install -g markdown-toc
markdown-toc README.md -i
markdown-toc CHANGELOG.md -i
sudo npm install -g markdown-link-check
markdown-link-check ./README.md
```

## Other resources

Yo generator :
<https://github.com/peterhendrick/openSource>

Thanks for reading!

# Contributing

The [issue tracker](https://github.com/AlbanAndrieu/nabla-servers-bower-sample/issues) is the preferred channel for bug reports, features requests and submitting pull requests.

For pull requests, editor preferences are available in the [editor config](.editorconfig) for easy use in common text editors. Read more and download plugins at <http://editorconfig.org>.

## License

[Apache v2](http://www.apache.org/licenses/LICENSE-2.0.html)

---

Alban Andrieu [linkedin](https://fr.linkedin.com/in/nabla/)
